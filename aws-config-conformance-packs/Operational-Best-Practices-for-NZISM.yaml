Parameters:
  DeployEdgeRules:
    Default: false
    Type: String
    AllowedValues:
      - true
      - false
Conditions:
  IsEdge:
    Fn::Equals:
      - Ref: DeployEdgeRules
      - true
Resources:
  AcmCertificateExpirationCheck:
    Controls: ['1667']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: acm-certificate-expiration-check
      InputParameters:
        daysToExpiration: '30'
      Scope:
        ComplianceResourceTypes:
          - AWS::ACM::Certificate
      Source:
        Owner: AWS
        SourceIdentifier: ACM_CERTIFICATE_EXPIRATION_CHECK
      Description: "SHOULD 14.5.8.C.01[CID:1667]| Software security/Web Application Development/Web applications"
  AlbHttpToHttpsRedirectionCheck:
    Controls: ['1847', '2090']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: alb-http-to-https-redirection-check
      Source:
        Owner: AWS
        SourceIdentifier: ALB_HTTP_TO_HTTPS_REDIRECTION_CHECK
      Description: "MUST 16.1.37.C.01[CID:1847], MUST 17.1.55.C.02[CID:2090]| Access Control and Passwords/Identification, Authentication and Passwords/Protecting authentication data in transit & Cryptography/..."
  AlbWafEnabled:
    Controls: ['3562', '4333', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: alb-waf-enabled
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::ElasticLoadBalancingV2::LoadBalancer
        # Scope:
        # TagKey: NZISM-Require-alb-waf-enabled
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: ALB_WAF_ENABLED
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 20.3.7.C.02[CID:4333], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Data management/Content Filtering/Content valid..."
  ApiGwAssociatedWithWaf:
    Controls: ['3562', '4333', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: api-gw-associated-with-waf
        # <EXEMPTION>
        # Scope:
        # TagKey: NZISM-Require-api-gw-associated-with-waf
      # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: API_GW_ASSOCIATED_WITH_WAF
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 20.3.7.C.02[CID:4333], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Data management/Content Filtering/Content valid..."
  ApiGwCacheEnabledAndEncrypted:
    Controls: ['2082']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: api-gw-cache-enabled-and-encrypted
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::ApiGateway::Stage
        # Scope:
        # TagKey: NZISM-Require-api-gw-cache-enabled-and-encrypted
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: API_GW_CACHE_ENABLED_AND_ENCRYPTED
      Description: "SHOULD 17.1.53.C.04[CID:2082]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements"
  ApiGwExecutionLoggingEnabled:
    Controls: ['2013', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: api-gw-execution-logging-enabled
      InputParameters:
        loggingLevel: 'ERROR, INFO'
      Scope:
        ComplianceResourceTypes:
          - AWS::ApiGateway::Stage
          - AWS::ApiGatewayV2::Stage
      Source:
        Owner: AWS
        SourceIdentifier: API_GW_EXECUTION_LOGGING_ENABLED
      Description: "SHOULD 16.6.10.C.02[CID:2013], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Additional events to be logged & Public Cloud Security/Logging and Alerti..."
  CloudTrailCloudWatchLogsEnabled:
    Controls: ['1998', '6860']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloud-trail-cloud-watch-logs-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUD_TRAIL_CLOUD_WATCH_LOGS_ENABLED
      Description: "SHOULD 16.6.6.C.02[CID:1998], MUST 16.4.35.C.02[CID:6860]| Access Control and Passwords: (Event Logging and Auditing/Maintaining system management logs & Privileged Access Management/Monito..."
  CloudTrailEncryptionEnabled:
    Controls: ['2082']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloud-trail-encryption-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUD_TRAIL_ENCRYPTION_ENABLED
      Description: "SHOULD 17.1.53.C.04[CID:2082]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements"
  CloudTrailLogFileValidationEnabled:
    Controls: ['2022', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloud-trail-log-file-validation-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUD_TRAIL_LOG_FILE_VALIDATION_ENABLED
      Description: "MUST 16.6.12.C.01[CID:2022], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Event log protection & Public Cloud Security/Logging and Alerting in Public..."
  CloudfrontAccesslogsEnabled:
    Condition: IsEdge
    Controls: ['2013', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudfront-accesslogs-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDFRONT_ACCESSLOGS_ENABLED
      Description: "SHOULD 16.6.10.C.02[CID:2013], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Additional events to be logged & Public Cloud Security/Logging and Alerti..."
  CloudfrontAssociatedWithWaf:
    Condition: IsEdge
    Controls: ['3562']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudfront-associated-with-waf
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDFRONT_ASSOCIATED_WITH_WAF
      Description: "MUST 19.1.12.C.01[CID:3562]| Gateway security/Gateways/Configuration of gateways"
  CloudfrontDefaultRootObjectConfigured:
    Condition: IsEdge
    Controls: ['1661']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudfront-default-root-object-configured
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDFRONT_DEFAULT_ROOT_OBJECT_CONFIGURED
      Description: "SHOULD 14.5.6.C.01[CID:1661]| Software security/Web Application Development/Agency website content"
  CloudfrontViewerPolicyHttps:
    Condition: IsEdge
    Controls: ['1847']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudfront-viewer-policy-https
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDFRONT_VIEWER_POLICY_HTTPS
      Description: "MUST 16.1.37.C.01[CID:1847]| Access Control and Passwords/Identification, Authentication and Passwords/Protecting authentication data in transit"
  CloudtrailEnabled:
    Controls: ['1998', '2013', '6860', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudtrail-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUD_TRAIL_ENABLED
      Description: "SHOULD 16.6.6.C.02[CID:1998], SHOULD 16.6.10.C.02[CID:2013], MUST 16.4.35.C.02[CID:6860], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords: (Event Logging and Auditing: (Maintainin..."
  CloudtrailS3DataeventsEnabled:
    Controls: ['4838']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudtrail-s3-dataevents-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDTRAIL_S3_DATAEVENTS_ENABLED
      Description: "SHOULD 22.1.24.C.03[CID:4838]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  CloudtrailSecurityTrailEnabled:
    Controls: ['6861']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudtrail-security-trail-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDTRAIL_SECURITY_TRAIL_ENABLED
      Description: "MUST 16.4.35.C.03[CID:6861]| Access Control and Passwords/Privileged Access Management/Monitoring and Review"
  CloudwatchLogGroupEncrypted:
    Controls: ['2022', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cloudwatch-log-group-encrypted
      Source:
        Owner: AWS
        SourceIdentifier: CLOUDWATCH_LOG_GROUP_ENCRYPTED
      Description: "MUST 16.6.12.C.01[CID:2022], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Event log protection & Public Cloud Security/Logging and Alerting in Public..."
  CmkBackingKeyRotationEnabled:
    Controls: ['3021']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cmk-backing-key-rotation-enabled
      Source:
        Owner: AWS
        SourceIdentifier: CMK_BACKING_KEY_ROTATION_ENABLED
      Description: "SHOULD 17.9.25.C.01[CID:3021]| Cryptography/Key Management/Contents of KMPs"
  CwLoggroupRetentionPeriodCheck:
    Controls: ['1998', '2028']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: cw-loggroup-retention-period-check
      InputParameters:
        MinRetentionTime: '545'
      Source:
        Owner: AWS
        SourceIdentifier: CW_LOGGROUP_RETENTION_PERIOD_CHECK
      Description: "SHOULD 16.6.6.C.02[CID:1998], MUST 16.6.13.C.01[CID:2028]| Access Control and Passwords/Event Logging and Auditing: (Maintaining system management logs & Event log archives)"
  DbInstanceBackupEnabled:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: db-instance-backup-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
      Source:
        Owner: AWS
        SourceIdentifier: DB_INSTANCE_BACKUP_ENABLED
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  DmsReplicationNotPublic:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: dms-replication-not-public
      Source:
        Owner: AWS
        SourceIdentifier: DMS_REPLICATION_NOT_PUBLIC
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  DynamodbAutoscalingEnabled:
    Controls: ['4829']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: dynamodb-autoscaling-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::DynamoDB::Table
      Source:
        Owner: AWS
        SourceIdentifier: DYNAMODB_AUTOSCALING_ENABLED
      Description: "MUST 22.1.23.C.01[CID:4829]| Enterprise systems security/Cloud Computing/System Availability"
  DynamodbInBackupPlan:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: dynamodb-in-backup-plan
        # <EXEMPTION>
        # Scope:
        # TagKey: NZISM-Require-dynamodb-in-backup-plan
      # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: DYNAMODB_IN_BACKUP_PLAN
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  DynamodbPitrEnabled:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: dynamodb-pitr-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::DynamoDB::Table
      Source:
        Owner: AWS
        SourceIdentifier: DYNAMODB_PITR_ENABLED
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  DynamodbTableEncryptedKms:
    Controls: ['4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: dynamodb-table-encrypted-kms
      Scope:
        ComplianceResourceTypes:
          - AWS::DynamoDB::Table
      Source:
        Owner: AWS
        SourceIdentifier: DYNAMODB_TABLE_ENCRYPTED_KMS
      Description: "SHOULD 22.1.24.C.04[CID:4839]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  EbsInBackupPlan:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ebs-in-backup-plan
        # <EXEMPTION>
        # Scope:
        # TagKey: NZISM-Require-ebs-in-backup-plan
      # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: EBS_IN_BACKUP_PLAN
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  EbsSnapshotPublicRestorableCheck:
    Controls: ['4838']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ebs-snapshot-public-restorable-check
      Source:
        Owner: AWS
        SourceIdentifier: EBS_SNAPSHOT_PUBLIC_RESTORABLE_CHECK
      Description: "SHOULD 22.1.24.C.03[CID:4838]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  Ec2EbsEncryptionByDefault:
    Controls: ['2082']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-ebs-encryption-by-default
      Source:
        Owner: AWS
        SourceIdentifier: EC2_EBS_ENCRYPTION_BY_DEFAULT
      Description: "SHOULD 17.1.53.C.04[CID:2082]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements"
  Ec2Imdsv2Check:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-imdsv2-check
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::Instance
      Source:
        Owner: AWS
        SourceIdentifier: EC2_IMDSV2_CHECK
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  Ec2InstanceManagedBySystemsManager:
    Controls: ['1149']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-instance-managed-by-systems-manager
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::Instance
          - AWS::SSM::ManagedInstanceInventory
      Source:
        Owner: AWS
        SourceIdentifier: EC2_INSTANCE_MANAGED_BY_SSM
      Description: "SHOULD 14.1.8.C.01[CID:1149]| Software security/Standard Operating Environments/Developing hardened SOEs"
  Ec2InstanceNoPublicIp:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-instance-no-public-ip
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::Instance
      Source:
        Owner: AWS
        SourceIdentifier: EC2_INSTANCE_NO_PUBLIC_IP
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  Ec2InstancesInVpc:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-instances-in-vpc
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::Instance
      Source:
        Owner: AWS
        SourceIdentifier: INSTANCES_IN_VPC
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  Ec2ManagedinstanceAssociationComplianceStatusCheck:
    Controls: ['1149']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-managedinstance-association-compliance-status-check
      Scope:
        ComplianceResourceTypes:
          - AWS::SSM::AssociationCompliance
      Source:
        Owner: AWS
        SourceIdentifier: EC2_MANAGEDINSTANCE_ASSOCIATION_COMPLIANCE_STATUS_CHECK
      Description: "SHOULD 14.1.8.C.01[CID:1149]| Software security/Standard Operating Environments/Developing hardened SOEs"
  Ec2ManagedinstancePatchComplianceStatusCheck:
    Controls: ['3449', '3451', '3452', '3453']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ec2-managedinstance-patch-compliance-status-check
      Scope:
        ComplianceResourceTypes:
          - AWS::SSM::PatchCompliance
      Source:
        Owner: AWS
        SourceIdentifier: EC2_MANAGEDINSTANCE_PATCH_COMPLIANCE_STATUS_CHECK
      Description: "MUST 12.4.4.C.02[CID:3449], SHOULD 12.4.4.C.04[CID:3451], SHOULD 12.4.4.C.05[CID:3452], SHOULD 12.4.4.C.06[CID:3453]| Product Security/Product Patching and Updating/Patching vulnerabilities..."
  EcrPrivateImageScanningEnabled:
    Controls: ['3449']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ecr-private-image-scanning-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::ECR::Repository
      Source:
        Owner: AWS
        SourceIdentifier: ECR_PRIVATE_IMAGE_SCANNING_ENABLED
      Description: "MUST 12.4.4.C.02[CID:3449]| Product Security/Product Patching and Updating/Patching vulnerabilities in products"
  EcsContainersNonprivileged:
    Controls: ['1149']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ecs-containers-nonprivileged
      Scope:
        ComplianceResourceTypes:
          - AWS::ECS::TaskDefinition
      Source:
        Owner: AWS
        SourceIdentifier: ECS_CONTAINERS_NONPRIVILEGED
      Description: "SHOULD 14.1.8.C.01[CID:1149]| Software security/Standard Operating Environments/Developing hardened SOEs"
  EcsContainersReadonlyAccess:
    Controls: ['1149']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ecs-containers-readonly-access
      Scope:
        ComplianceResourceTypes:
          - AWS::ECS::TaskDefinition
      Source:
        Owner: AWS
        SourceIdentifier: ECS_CONTAINERS_READONLY_ACCESS
      Description: "SHOULD 14.1.8.C.01[CID:1149]| Software security/Standard Operating Environments/Developing hardened SOEs"
  EfsEncryptedCheck:
    Controls: ['2082', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: efs-encrypted-check
      Source:
        Owner: AWS
        SourceIdentifier: EFS_ENCRYPTED_CHECK
      Description: "SHOULD 17.1.53.C.04[CID:2082], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements & Enterprise systems security/Cloud..."
  EfsInBackupPlan:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: efs-in-backup-plan
        # <EXEMPTION>
        # Scope:
        # TagKey: NZISM-Require-efs-in-backup-plan
      # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: EFS_IN_BACKUP_PLAN
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  ElasticBeanstalkManagedUpdatesEnabled:
    Controls: ['3452']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elastic-beanstalk-managed-updates-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::ElasticBeanstalk::Environment
      Source:
        Owner: AWS
        SourceIdentifier: ELASTIC_BEANSTALK_MANAGED_UPDATES_ENABLED
      Description: "SHOULD 12.4.4.C.05[CID:3452]| Product Security/Product Patching and Updating/Patching vulnerabilities in products"
  ElasticacheRedisClusterAutomaticBackupCheck:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elasticache-redis-cluster-automatic-backup-check
      Source:
        Owner: AWS
        SourceIdentifier: ELASTICACHE_REDIS_CLUSTER_AUTOMATIC_BACKUP_CHECK
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  ElasticsearchEncryptedAtRest:
    Controls: ['2082', '4441', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elasticsearch-encrypted-at-rest
      Source:
        Owner: AWS
        SourceIdentifier: ELASTICSEARCH_ENCRYPTED_AT_REST
      Description: "SHOULD 17.1.53.C.04[CID:2082], SHOULD 20.4.4.C.02[CID:4441], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements & Dat..."
  ElasticsearchInVpcOnly:
    Controls: ['3562', '3623', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elasticsearch-in-vpc-only
      Source:
        Owner: AWS
        SourceIdentifier: ELASTICSEARCH_IN_VPC_ONLY
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 19.1.14.C.02[CID:3623], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways: (Configuration of gateways & Demilitarised zones) & Public Cloud Security..."
  ElasticsearchNodeToNodeEncryptionCheck:
    Controls: ['1847', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elasticsearch-node-to-node-encryption-check
      Scope:
        ComplianceResourceTypes:
          - AWS::Elasticsearch::Domain
      Source:
        Owner: AWS
        SourceIdentifier: ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK
      Description: "MUST 16.1.37.C.01[CID:1847], SHOULD 22.1.24.C.04[CID:4839]| Access Control and Passwords/Identification, Authentication and Passwords/Protecting authentication data in transit & Enterprise ..."
  ElbCrossZoneLoadBalancingEnabled:
    Controls: ['4829']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elb-cross-zone-load-balancing-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::ElasticLoadBalancing::LoadBalancer
      Source:
        Owner: AWS
        SourceIdentifier: ELB_CROSS_ZONE_LOAD_BALANCING_ENABLED
      Description: "MUST 22.1.23.C.01[CID:4829]| Enterprise systems security/Cloud Computing/System Availability"
  ElbCustomSecurityPolicySslCheck:
    Controls: ['2598', '2600']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elb-custom-security-policy-ssl-check
      InputParameters:
        sslProtocolsAndCiphers: 'Protocol-TLSv1.2,ECDHE-ECDSA-AES256-GCM-SHA384'
      Scope:
        ComplianceResourceTypes:
          - AWS::ElasticLoadBalancing::LoadBalancer
      Source:
        Owner: AWS
        SourceIdentifier: ELB_CUSTOM_SECURITY_POLICY_SSL_CHECK
      Description: "SHOULD 17.4.16.C.01[CID:2598], SHOULD NOT 17.4.16.C.02[CID:2600]| Cryptography/Transport Layer Security/Using TLS"
  ElbLoggingEnabled:
    Controls: ['2013', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elb-logging-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::ElasticLoadBalancing::LoadBalancer
          - AWS::ElasticLoadBalancingV2::LoadBalancer
      Source:
        Owner: AWS
        SourceIdentifier: ELB_LOGGING_ENABLED
      Description: "SHOULD 16.6.10.C.02[CID:2013], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Additional events to be logged & Public Cloud Security/Logging and Alerti..."
  ElbTlsHttpsListenersOnly:
    Controls: ['1667', '1847', '2090', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: elb-tls-https-listeners-only
      Scope:
        ComplianceResourceTypes:
          - AWS::ElasticLoadBalancing::LoadBalancer
      Source:
        Owner: AWS
        SourceIdentifier: ELB_TLS_HTTPS_LISTENERS_ONLY
      Description: "SHOULD 14.5.8.C.01[CID:1667], MUST 16.1.37.C.01[CID:1847], MUST 17.1.55.C.02[CID:2090], SHOULD 22.1.24.C.04[CID:4839]| Software security/Web Application Development/Web applications & Acces..."
  EmrMasterNoPublicIp:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: emr-master-no-public-ip
      Source:
        Owner: AWS
        SourceIdentifier: EMR_MASTER_NO_PUBLIC_IP
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  EncryptedVolumes:
    Controls: ['2082', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: encrypted-volumes
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::Volume
      Source:
        Owner: AWS
        SourceIdentifier: ENCRYPTED_VOLUMES
      Description: "SHOULD 17.1.53.C.04[CID:2082], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements & Enterprise systems security/Cloud..."
  GuarddutyEksProtectionAuditEnabled:
    Controls: ['3857']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: guardduty-eks-protection-audit-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::GuardDuty::Detector
      Source:
        Owner: AWS
        SourceIdentifier: GUARDDUTY_EKS_PROTECTION_AUDIT_ENABLED
      Description: "SHOULD 18.4.11.C.01[CID:3857]| Network security/Intrusion Detection and Prevention/Configuring the IDS/IPS"
  GuarddutyEksProtectionRuntimeEnabled:
    Controls: ['3857']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: guardduty-eks-protection-runtime-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::GuardDuty::Detector
      Source:
        Owner: AWS
        SourceIdentifier: GUARDDUTY_EKS_PROTECTION_RUNTIME_ENABLED
      Description: "SHOULD 18.4.11.C.01[CID:3857]| Network security/Intrusion Detection and Prevention/Configuring the IDS/IPS"
  GuarddutyEnabledCentralized:
    Controls: ['3562', '3815', '3875', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: guardduty-enabled-centralized
      Source:
        Owner: AWS
        SourceIdentifier: GUARDDUTY_ENABLED_CENTRALIZED
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 18.4.9.C.01[CID:3815], SHOULD 18.4.12.C.01[CID:3875], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Network security/I..."
  GuarddutyLambdaProtectionEnabled:
    Controls: ['3857']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: guardduty-lambda-protection-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::GuardDuty::Detector
      Source:
        Owner: AWS
        SourceIdentifier: GUARDDUTY_LAMBDA_PROTECTION_ENABLED
      Description: "SHOULD 18.4.11.C.01[CID:3857]| Network security/Intrusion Detection and Prevention/Configuring the IDS/IPS"
  GuarddutyS3ProtectionEnabled:
    Controls: ['3857']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: guardduty-s3-protection-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::GuardDuty::Detector
      Source:
        Owner: AWS
        SourceIdentifier: GUARDDUTY_S3_PROTECTION_ENABLED
      Description: "SHOULD 18.4.11.C.01[CID:3857]| Network security/Intrusion Detection and Prevention/Configuring the IDS/IPS"
  IamPasswordPolicy:
    Controls: ['1858']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: iam-password-policy
      InputParameters:
        MaxPasswordAge: '90'
        MinimumPasswordLength: '10'
        PasswordReusePrevention: '8'
        RequireUppercaseCharacters: 'true'
        RequireLowercaseCharacters: 'true'
        RequireSymbols: 'true'
        RequireNumbers: 'true'
      Source:
        Owner: AWS
        SourceIdentifier: IAM_PASSWORD_POLICY
      Description: "SHOULD 16.1.40.C.02[CID:1858]| Access Control and Passwords/Identification, Authentication and Passwords/Password selection policy"
  IamPolicyNoStatementsWithAdminAccess:
    Controls: ['1946']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: iam-policy-no-statements-with-admin-access
      Scope:
        ComplianceResourceTypes:
          - AWS::IAM::Policy
      Source:
        Owner: AWS
        SourceIdentifier: IAM_POLICY_NO_STATEMENTS_WITH_ADMIN_ACCESS
      Description: "SHOULD 16.3.5.C.02[CID:1946]| Access Control and Passwords/Privileged User Access/Use of privileged accounts"
  IamRootAccessKeyCheck:
    Controls: ['1946']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: iam-root-access-key-check
      Source:
        Owner: AWS
        SourceIdentifier: IAM_ROOT_ACCESS_KEY_CHECK
      Description: "SHOULD 16.3.5.C.02[CID:1946]| Access Control and Passwords/Privileged User Access/Use of privileged accounts"
  IamUserMfaEnabled:
    Controls: ['1841', '7436', '7437']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: iam-user-mfa-enabled
      Source:
        Owner: AWS
        SourceIdentifier: IAM_USER_MFA_ENABLED
      Description: "SHOULD 16.1.35.C.02[CID:1841], MUST 23.3.19.C.01[CID:7436], MUST 23.3.19.C.01[CID:7437]| Access Control and Passwords/Identification, Authentication and Passwords/Methods for system user id..."
  IamUserUnusedCredentialsCheck:
    Controls: ['1893', '6852']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: iam-user-unused-credentials-check
      InputParameters:
        maxCredentialUsageAge: '90'
      Source:
        Owner: AWS
        SourceIdentifier: IAM_USER_UNUSED_CREDENTIALS_CHECK
      Description: "SHOULD 16.1.46.C.02[CID:1893], MUST 16.4.33.C.01[CID:6852]| Access Control and Passwords: (Identification, Authentication and Passwords/Suspension of access & Privileged Access Management/S..."
  LambdaFunctionPublicAccessProhibited:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: lambda-function-public-access-prohibited
      Scope:
        ComplianceResourceTypes:
          - AWS::Lambda::Function
      Source:
        Owner: AWS
        SourceIdentifier: LAMBDA_FUNCTION_PUBLIC_ACCESS_PROHIBITED
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  MfaEnabledForIamConsoleAccess:
    Controls: ['1841', '6843', '6953', '7436', '7437']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: mfa-enabled-for-iam-console-access
      Source:
        Owner: AWS
        SourceIdentifier: MFA_ENABLED_FOR_IAM_CONSOLE_ACCESS
      Description: "SHOULD 16.1.35.C.02[CID:1841], SHOULD 16.4.31.C.02[CID:6843], SHOULD 16.7.34.C.02[CID:6953], MUST 23.3.19.C.01[CID:7436], MUST 23.3.19.C.01[CID:7437]| Access Control and Passwords: (Identif..."
  OpensearchEncryptedAtRest:
    Controls: ['2082', '4441', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: opensearch-encrypted-at-rest
      Scope:
        ComplianceResourceTypes:
          - AWS::OpenSearch::Domain
      Source:
        Owner: AWS
        SourceIdentifier: OPENSEARCH_ENCRYPTED_AT_REST
      Description: "SHOULD 17.1.53.C.04[CID:2082], SHOULD 20.4.4.C.02[CID:4441], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements & Dat..."
  OpensearchInVpcOnly:
    Controls: ['3562', '3623', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: opensearch-in-vpc-only
      Scope:
        ComplianceResourceTypes:
          - AWS::OpenSearch::Domain
      Source:
        Owner: AWS
        SourceIdentifier: OPENSEARCH_IN_VPC_ONLY
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 19.1.14.C.02[CID:3623], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways: (Configuration of gateways & Demilitarised zones) & Public Cloud Security..."
  OpensearchNodeToNodeEncryptionCheck:
    Controls: ['1847', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: opensearch-node-to-node-encryption-check
      Scope:
        ComplianceResourceTypes:
          - AWS::OpenSearch::Domain
      Source:
        Owner: AWS
        SourceIdentifier: OPENSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK
      Description: "MUST 16.1.37.C.01[CID:1847], SHOULD 22.1.24.C.04[CID:4839]| Access Control and Passwords/Identification, Authentication and Passwords/Protecting authentication data in transit & Enterprise ..."
  RdsAutomaticMinorVersionUpgradeEnabled:
    Controls: ['3452']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-automatic-minor-version-upgrade-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
      Source:
        Owner: AWS
        SourceIdentifier: RDS_AUTOMATIC_MINOR_VERSION_UPGRADE_ENABLED
      Description: "SHOULD 12.4.4.C.05[CID:3452]| Product Security/Product Patching and Updating/Patching vulnerabilities in products"
  RdsClusterDeletionProtectionEnabled:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-cluster-deletion-protection-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBCluster
      Source:
        Owner: AWS
        SourceIdentifier: RDS_CLUSTER_DELETION_PROTECTION_ENABLED
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  RdsClusterMultiAzEnabled:
    Controls: ['4829']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-cluster-multi-az-enabled
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBCluster
        # Scope:
        # TagKey: NZISM-Require-rds-cluster-multi-az-enabled
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: RDS_CLUSTER_MULTI_AZ_ENABLED
      Description: "MUST 22.1.23.C.01[CID:4829]| Enterprise systems security/Cloud Computing/System Availability"
  RdsInBackupPlan:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-in-backup-plan
        # <EXEMPTION>
        # Scope:
        # TagKey: NZISM-Require-rds-in-backup-plan
      # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: RDS_IN_BACKUP_PLAN
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  RdsInstanceDeletionProtectionEnabled:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-instance-deletion-protection-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
      Source:
        Owner: AWS
        SourceIdentifier: RDS_INSTANCE_DELETION_PROTECTION_ENABLED
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  RdsInstancePublicAccessCheck:
    Controls: ['3562', '3623', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-instance-public-access-check
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
      Source:
        Owner: AWS
        SourceIdentifier: RDS_INSTANCE_PUBLIC_ACCESS_CHECK
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 19.1.14.C.02[CID:3623], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways: (Configuration of gateways & Demilitarised zones) & Public Cloud Security..."
  RdsLoggingEnabled:
    Controls: ['2013', '4441', '4445', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-logging-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
      Source:
        Owner: AWS
        SourceIdentifier: RDS_LOGGING_ENABLED
      Description: "SHOULD 16.6.10.C.02[CID:2013], SHOULD 20.4.4.C.02[CID:4441], SHOULD 20.4.5.C.02[CID:4445], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Additional ev..."
  RdsMultiAzSupport:
    Controls: ['4829']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-multi-az-support
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
        # Scope:
        # TagKey: NZISM-Require-rds-multi-az-support
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: RDS_MULTI_AZ_SUPPORT
      Description: "MUST 22.1.23.C.01[CID:4829]| Enterprise systems security/Cloud Computing/System Availability"
  RdsSnapshotEncrypted:
    Controls: ['2082', '4441', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-snapshot-encrypted
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBSnapshot
          - AWS::RDS::DBClusterSnapshot
      Source:
        Owner: AWS
        SourceIdentifier: RDS_SNAPSHOT_ENCRYPTED
      Description: "SHOULD 17.1.53.C.04[CID:2082], SHOULD 20.4.4.C.02[CID:4441], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements & Dat..."
  RdsSnapshotsPublicProhibited:
    Controls: ['4441']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-snapshots-public-prohibited
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBSnapshot
          - AWS::RDS::DBClusterSnapshot
      Source:
        Owner: AWS
        SourceIdentifier: RDS_SNAPSHOTS_PUBLIC_PROHIBITED
      Description: "SHOULD 20.4.4.C.02[CID:4441]| Data management/Databases/Database files"
  RdsStorageEncrypted:
    Controls: ['2082', '4441', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: rds-storage-encrypted
      Scope:
        ComplianceResourceTypes:
          - AWS::RDS::DBInstance
      Source:
        Owner: AWS
        SourceIdentifier: RDS_STORAGE_ENCRYPTED
      Description: "SHOULD 17.1.53.C.04[CID:2082], SHOULD 20.4.4.C.02[CID:4441], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements & Dat..."
  RedshiftBackupEnabled:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: redshift-backup-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::Redshift::Cluster
      Source:
        Owner: AWS
        SourceIdentifier: REDSHIFT_BACKUP_ENABLED
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  RedshiftClusterConfigurationCheck:
    Controls: ['4441', '4445', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: redshift-cluster-configuration-check
      InputParameters:
        clusterDbEncrypted: 'true'
        loggingEnabled: 'true'
      Scope:
        ComplianceResourceTypes:
          - AWS::Redshift::Cluster
      Source:
        Owner: AWS
        SourceIdentifier: REDSHIFT_CLUSTER_CONFIGURATION_CHECK
      Description: "SHOULD 20.4.4.C.02[CID:4441], SHOULD 20.4.5.C.02[CID:4445], SHOULD 22.1.24.C.04[CID:4839]| Data management/Databases: (Database files & Accountability) & Enterprise systems security/Cloud C..."
  RedshiftClusterMaintenancesettingsCheck:
    Controls: ['3449', '3453']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: redshift-cluster-maintenancesettings-check
      InputParameters:
        allowVersionUpgrade: 'true'
      Scope:
        ComplianceResourceTypes:
          - AWS::Redshift::Cluster
      Source:
        Owner: AWS
        SourceIdentifier: REDSHIFT_CLUSTER_MAINTENANCESETTINGS_CHECK
      Description: "MUST 12.4.4.C.02[CID:3449], SHOULD 12.4.4.C.06[CID:3453]| Product Security/Product Patching and Updating/Patching vulnerabilities in products"
  RedshiftClusterPublicAccessCheck:
    Controls: ['3562', '3623', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: redshift-cluster-public-access-check
      Scope:
        ComplianceResourceTypes:
          - AWS::Redshift::Cluster
      Source:
        Owner: AWS
        SourceIdentifier: REDSHIFT_CLUSTER_PUBLIC_ACCESS_CHECK
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 19.1.14.C.02[CID:3623], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways: (Configuration of gateways & Demilitarised zones) & Public Cloud Security..."
  RedshiftRequireTlsSsl:
    Controls: ['2090', '4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: redshift-require-tls-ssl
      Scope:
        ComplianceResourceTypes:
          - AWS::Redshift::Cluster
      Source:
        Owner: AWS
        SourceIdentifier: REDSHIFT_REQUIRE_TLS_SSL
      Description: "MUST 17.1.55.C.02[CID:2090], SHOULD 22.1.24.C.04[CID:4839]| Cryptography/Cryptographic Fundamentals/Information and Systems Protection & Enterprise systems security/Cloud Computing/Unauthor..."
  RestrictedSsh:
    Controls: ['2726']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: restricted-ssh
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::SecurityGroup
      Source:
        Owner: AWS
        SourceIdentifier: INCOMING_SSH_DISABLED
      Description: "SHOULD 17.5.8.C.02[CID:2726]| Cryptography/Secure Shell/Automated remote access"
  RootAccountHardwareMfaEnabled:
    Controls: ['1841', '6843', '6953', '7436', '7437']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: root-account-hardware-mfa-enabled
      Source:
        Owner: AWS
        SourceIdentifier: ROOT_ACCOUNT_HARDWARE_MFA_ENABLED
      Description: "SHOULD 16.1.35.C.02[CID:1841], SHOULD 16.4.31.C.02[CID:6843], SHOULD 16.7.34.C.02[CID:6953], MUST 23.3.19.C.01[CID:7436], MUST 23.3.19.C.01[CID:7437]| Access Control and Passwords: (Identif..."
  RootAccountMfaEnabled:
    Controls: ['1841', '7436', '7437']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: root-account-mfa-enabled
      Source:
        Owner: AWS
        SourceIdentifier: ROOT_ACCOUNT_MFA_ENABLED
      Description: "SHOULD 16.1.35.C.02[CID:1841], MUST 23.3.19.C.01[CID:7436], MUST 23.3.19.C.01[CID:7437]| Access Control and Passwords/Identification, Authentication and Passwords/Methods for system user id..."
  S3AccountLevelPublicAccessBlocksPeriodic:
    Controls: ['3562', '4838', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-account-level-public-access-blocks-periodic
      Source:
        Owner: AWS
        SourceIdentifier: S3_ACCOUNT_LEVEL_PUBLIC_ACCESS_BLOCKS_PERIODIC
      Description: "MUST 19.1.12.C.01[CID:3562], SHOULD 22.1.24.C.03[CID:4838], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Enterprise systems security/Cloud Computing/Un..."
  S3BucketPublicReadProhibited:
    Controls: ['4838']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-bucket-public-read-prohibited
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_PUBLIC_READ_PROHIBITED
      Description: "SHOULD 22.1.24.C.03[CID:4838]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  S3BucketPublicWriteProhibited:
    Controls: ['4838']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-bucket-public-write-prohibited
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_PUBLIC_WRITE_PROHIBITED
      Description: "SHOULD 22.1.24.C.03[CID:4838]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  S3BucketServerSideEncryptionEnabled:
    Controls: ['2082']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-bucket-server-side-encryption-enabled
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED
      Description: "SHOULD 17.1.53.C.04[CID:2082]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements"
  S3BucketSslRequestsOnly:
    Controls: ['4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-bucket-ssl-requests-only
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_SSL_REQUESTS_ONLY
      Description: "SHOULD 22.1.24.C.04[CID:4839]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  S3BucketVersioningEnabled:
    Controls: ['4849']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-bucket-versioning-enabled
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
        # Scope:
        # TagKey: NZISM-Require-s3-bucket-versioning-enabled
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_VERSIONING_ENABLED
      Description: "MUST 22.1.26.C.01[CID:4849]| Enterprise systems security/Cloud Computing/Backup, Recovery Archiving and Data Remanence"
  S3DefaultEncryptionKms:
    Controls: ['2082']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-default-encryption-kms
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::S3::Bucket
        # Scope:
        # TagKey: NZISM-Require-s3-default-encryption-kms
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: S3_DEFAULT_ENCRYPTION_KMS
      Description: "SHOULD 17.1.53.C.04[CID:2082]| Cryptography/Cryptographic Fundamentals/Reducing storage and physical transfer requirements"
  SagemakerEndpointConfigurationKmsKeyConfigured:
    Controls: ['4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: sagemaker-endpoint-configuration-kms-key-configured
      Source:
        Owner: AWS
        SourceIdentifier: SAGEMAKER_ENDPOINT_CONFIGURATION_KMS_KEY_CONFIGURED
      Description: "SHOULD 22.1.24.C.04[CID:4839]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  SagemakerNotebookInstanceKmsKeyConfigured:
    Controls: ['4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: sagemaker-notebook-instance-kms-key-configured
      Source:
        Owner: AWS
        SourceIdentifier: SAGEMAKER_NOTEBOOK_INSTANCE_KMS_KEY_CONFIGURED
      Description: "SHOULD 22.1.24.C.04[CID:4839]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  SagemakerNotebookNoDirectInternetAccess:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: sagemaker-notebook-no-direct-internet-access
      Source:
        Owner: AWS
        SourceIdentifier: SAGEMAKER_NOTEBOOK_NO_DIRECT_INTERNET_ACCESS
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  SecretsmanagerUsingCmk:
    Controls: ['4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: secretsmanager-using-cmk
      Scope:
        ComplianceResourceTypes:
          - AWS::SecretsManager::Secret
      Source:
        Owner: AWS
        SourceIdentifier: SECRETSMANAGER_USING_CMK
      Description: "SHOULD 22.1.24.C.04[CID:4839]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  SecurityhubEnabled:
    Controls: ['3875']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: securityhub-enabled
      Source:
        Owner: AWS
        SourceIdentifier: SECURITYHUB_ENABLED
      Description: "SHOULD 18.4.12.C.01[CID:3875]| Network security/Intrusion Detection and Prevention/Event management and correlation"
  SnsEncryptedKms:
    Controls: ['4839']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: sns-encrypted-kms
      # <EXEMPTION>
      Scope:
        ComplianceResourceTypes:
          - AWS::SNS::Topic
        # Scope:
        # TagKey: NZISM-Require-sns-encrypted-kms
        # TagValue: true
      # </EXEMPTION>
      Source:
        Owner: AWS
        SourceIdentifier: SNS_ENCRYPTED_KMS
      Description: "SHOULD 22.1.24.C.04[CID:4839]| Enterprise systems security/Cloud Computing/Unauthorised Access"
  SsmDocumentNotPublic:
    Controls: ['7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: ssm-document-not-public
      Source:
        Owner: AWS
        SourceIdentifier: SSM_DOCUMENT_NOT_PUBLIC
      Description: "MUST 23.4.10.C.01[CID:7466]| Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  VpcDefaultSecurityGroupClosed:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: vpc-default-security-group-closed
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::SecurityGroup
      Source:
        Owner: AWS
        SourceIdentifier: VPC_DEFAULT_SECURITY_GROUP_CLOSED
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  VpcFlowLogsEnabled:
    Controls: ['3562', '7466']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: vpc-flow-logs-enabled
      Source:
        Owner: AWS
        SourceIdentifier: VPC_FLOW_LOGS_ENABLED
      Description: "MUST 19.1.12.C.01[CID:3562], MUST 23.4.10.C.01[CID:7466]| Gateway security/Gateways/Configuration of gateways & Public Cloud Security/Data Protection in Public Cloud/Data accessibility"
  VpcSgOpenOnlyToAuthorizedPorts:
    Controls: ['3205']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: vpc-sg-open-only-to-authorized-ports
      InputParameters:
        authorizedTcpPorts: '443'
      Scope:
        ComplianceResourceTypes:
          - AWS::EC2::SecurityGroup
      Source:
        Owner: AWS
        SourceIdentifier: VPC_SG_OPEN_ONLY_TO_AUTHORIZED_PORTS
      Description: "SHOULD 18.1.13.C.02[CID:3205]| Network security/Network Management/Limiting network access"
  Wafv2LoggingEnabled:
    Controls: ['2013', '7496']
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: wafv2-logging-enabled
      Source:
        Owner: AWS
        SourceIdentifier: WAFV2_LOGGING_ENABLED
      Description: "SHOULD 16.6.10.C.02[CID:2013], MUST 23.5.11.C.01[CID:7496]| Access Control and Passwords/Event Logging and Auditing/Additional events to be logged & Public Cloud Security/Logging and Alerti..."